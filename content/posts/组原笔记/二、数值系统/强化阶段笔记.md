---
title: 强化阶段笔记
date: 2025-07-24T18:10:32.422642+08:00
tags: ['组原笔记', '二、数值系统', '强化阶段笔记.md']
url: /posts/ZG8FqFE2P7
author: "Yan2u"
IsPost: true
ShowReadingTime: true
ShowBreadCrumbs: true
ShowPostNavLinks: true
showToc: true
TocOpen: false
ShowWordCount: true
UseHugoToc: true
---

<a href="/notes408/chapters_index"> Indexes </a> > <a href="/notes408/indexes/5RoFxkg3V7"> 组原笔记 </a> > <a href="/notes408/indexes/ow4MryjPak"> 二、数值系统 </a> > 强化阶段笔记

### 1. 定点整数运算

#### 1.1. 16 进制补码和 10 进制

- 如果前导 `F` 比较多，利用 `0x(FFFF...F) = -1` ，用 `-1` 减去二进制就可以消去所有 `F`，然后列方程解出十进制。
- 二级结论：`0xFFFX -> X - 16`，`0XFFXY -> 16X + Y - 256`。

### 2. 浮点数

#### 2.1. 加减法舍入操作

- 发生在对阶、尾数加减、规格化的所有操作最后。
- 在这之前，**左右规产生的补位都保留**（即使超过有效位数）。
- 舍入时，丢弃尾数**最后一段超出长度的部分**，同时，若**丢弃的部分最高位为 1，则丢完后尾数末尾 +1，否则不变**。
- 注意：判断要不要加 1 单独在舍入阶段进行，和左右规无关！

#### 2.2. IEEE754 单精度加减法

- 结构：`F32 = 1 + 8 + 23`，1 位尾数符号，8 位移码阶码，23 位原码尾数（省略最高位 1，实际尾数 24 位）
- **省略的 1 是个位的，权重是 1 而不是 $1/2$ ！**
- 注意事项
  - 先对阶，对阶时就要还原尾数最高位省略的 1。
  - 加减完要规格化。
  - 最后还要记得把最高位 1 省掉。
  - **减法一般不用补码算**，手动判断哪个更大，先得符号，最后绝对值大减小的即可。

#### 2.3. 精度问题

- 若两个浮点数 $A$ 和 $B$ 加减，$A$ 的阶码远大于 $B$ 的阶码，**则在对阶时，$B$ 可能因为右规超出尾数位数**，导致尾数变为 0。
  - 此时 $A+B$ 或 $A-B$ 结果都是 $A$。产生误差。

### 题目

- 1. 有三个变量 `int i`，`float f`，`double d`。其中 `i = 785`，`f = 1.5678e3`，`d=1.5e100`。设 `int` 用补码表示，`float` 和 `double` 分别用 IEEE754 单/双精度浮点数。在 32 位机器上执行下列判断式，结果为 true 的是（）

  - （1）`i == (int)(float) i`；
  - （2）`f == (float)(int) f`；
  - （3）`f == (float)(double) f`；
  - （4）`(d + f) - d == f`；
  - A. 1，2；
  - B. 1，3；
  - C. 2，3；
  - D. 3，4；
  - **答案**：B
  - **解析**：2 和 3 很好判断。主要是判断 1 和 4 的对错。
    - 对于 1，785 的二进制位数不超过 24 位，可以用单精度浮点数**精确表示**。所以相等。
      - 换言之，若超过 $2^{24}=16777216$，即超出 24 位尾数能表示的最大范围，就会出现误差。
      - 对于 $2^{24}$ 虽然需要 25 位二进制，**但是除最高位外全 0**。因此可用 $1.0\times 2^{24}$ 表示，尾数全 0，阶码 $j=24+127$。
      - 若整数超过 $2^{24}$，则至少需要 25 位二进制来表示，**且除最高位外不为全 0**，因此尾数部分会舍入，导致误差。
    - 对于 3，要注意到 **d 和 f 的阶码（数量级）差异巨大**。在对阶时，f 尾数会右移过多导致舍入为 0。因此 `(d + f) - d` **实际上应得机器 0**。所以不等。
    - **拓展**：对于超出 $2^{24}$ 的整数，**并非都不能被精确表示**，而是**能被精确表示的数字间隔已经大于了 1**（浮点数的步长）
      - 例如，在 $[2^{24},2^{25})$ 范围内的整数，需要 25 位二进制表示。
      - 由于 24 位尾数，会有 1 位最低位被丢弃。**若最低位本来就是 0，则不会产生误差**。
      - 因此，能被精确表示的整数最低位都是 0，即**偶数**。
      - 同理可推得 $[2^{25},2^{26})$ 区间内的整数，仅当**最低两位为 0** 时才能避免舍入误差。**即 4 的倍数**。以此类推直到阶码溢出。
    - **总结**：在 IEEE754 表示下，设尾数位数为 $R$（不算最高位），则一个数 $N$ 能被精确表示
      - $N$ 表示为二进制科学计数法 $(1.M)_2^j$  后，**有效小数部分 $M$ 不得超过 $R$ 位**，且 $j$ 不超过阶码表示范围。
      - 对于单精度 $R=23$，双精度 $R=52$。
      - $N$ 无论是整数 or 小数都适用。
